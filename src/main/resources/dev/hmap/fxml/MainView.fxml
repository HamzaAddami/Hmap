<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.geometry.Insets?>

<AnchorPane stylesheets="/styles/styles.css" prefHeight="800.0" prefWidth="1200.0" styleClass="root-pane"
            xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="dev.hmap.controllers.MainController">


    <!-- Sidebar Menu -->
    <VBox fx:id="sideMenu" prefHeight="800.0" prefWidth="250.0" styleClass="sidebar-menu"
          AnchorPane.topAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.bottomAnchor="0.0">
        <padding>
            <Insets top="20.0" right="10.0" bottom="20.0" left="10.0"/>
        </padding>
        <children>
            <Label text="H-MAP SCANNER" styleClass="app-logo-text">
                <font>
                    <Font name="System Bold" size="18.0"/>
                </font>
                <VBox.margin>
                    <Insets bottom="50.0"/>
                </VBox.margin>
            </Label>

            <Button text="Dashboard" styleClass="menu-button" prefWidth="230.0">
                <VBox.margin>
                    <Insets bottom="10.0"/>
                </VBox.margin>
            </Button>

            <Button text="Host Discovery" styleClass="menu-button" prefWidth="230.0">
                <VBox.margin>
                    <Insets bottom="10.0"/>
                </VBox.margin>
            </Button>

            <Button text="Scan" styleClass="menu-button-active" prefWidth="230.0"/>
        </children>
    </VBox>

    <!-- Main Content Area -->
    <VBox layoutX="250.0" prefHeight="800.0" prefWidth="950.0" styleClass="content-area"
          AnchorPane.topAnchor="0.0" AnchorPane.rightAnchor="0.0"
          AnchorPane.bottomAnchor="0.0" AnchorPane.leftAnchor="250.0">
        <padding>
            <Insets top="40.0" right="40.0" bottom="40.0" left="40.0"/>
        </padding>
        <children>
            <!-- Page Title -->
            <Label text="Port Scanner" styleClass="main-title">
                <font>
                    <Font name="System Bold" size="24.0"/>
                </font>
                <VBox.margin>
                    <Insets bottom="30.0"/>
                </VBox.margin>
            </Label>

            <!-- Main Content: Scan Configuration + Results -->
            <HBox spacing="30.0" VBox.vgrow="ALWAYS">

                <!-- Left Panel: Scan Configuration -->
                <VBox prefWidth="400.0" styleClass="scan-card" spacing="20.0">
                    <padding>
                        <Insets topRightBottomLeft="20.0"/>
                    </padding>
                    <children>
                        <Label text="New Scan" styleClass="card-title">
                            <font>
                                <Font name="System Bold" size="16.0"/>
                            </font>
                        </Label>

                        <!-- Scan Type Selection -->
                        <VBox spacing="10.0">
                            <children>
                                <Label text="Scan Type" styleClass="input-label"/>
                                <HBox spacing="10.0" alignment="CENTER_LEFT">
                                    <children>
                                        <fx:define>
                                            <ToggleGroup fx:id="scanTypeGroup"/>
                                        </fx:define>
                                        <ToggleButton text="TCP Connect" styleClass="scan-toggle"
                                                      selected="true" toggleGroup="$scanTypeGroup"/>
                                        <ToggleButton text="UDP" styleClass="scan-toggle"
                                                      toggleGroup="$scanTypeGroup"/>
                                        <ToggleButton text="TCP SYN" styleClass="scan-toggle"
                                                      toggleGroup="$scanTypeGroup"/>
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- Target Host Input -->
                        <VBox spacing="10.0">
                            <children>
                                <Label text="Target Host" styleClass="input-label"/>
                                <TextField fx:id="targetHostField" promptText="e.g., 192.168.1.1"
                                           styleClass="input-field"/>
                            </children>
                        </VBox>

                        <!-- Port Range Input -->
                        <VBox spacing="10.0">
                            <children>
                                <Label text="Port Range" styleClass="input-label"/>
                                <HBox spacing="10.0" alignment="CENTER_LEFT">
                                    <children>
                                        <TextField fx:id="startPortField" promptText="Start"
                                                   prefWidth="80.0" text="1" styleClass="input-field"/>
                                        <Label text="-"/>
                                        <TextField fx:id="endPortField" promptText="End"
                                                   prefWidth="80.0" text="1024" styleClass="input-field"/>
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- Timeout Input -->
                        <VBox spacing="10.0">
                            <children>
                                <Label text="Timeout (ms)" styleClass="input-label"/>
                                <TextField fx:id="timeoutField" promptText="1000"
                                           prefWidth="150.0" text="1000" styleClass="input-field"/>
                            </children>
                        </VBox>

                        <!-- Thread Count -->
                        <VBox spacing="10.0">
                            <children>
                                <Label text="Concurrent Threads" styleClass="input-label"/>
                                <Slider fx:id="threadSlider" min="1" max="100" value="10"
                                        showTickLabels="true" showTickMarks="true"
                                        majorTickUnit="25" minorTickCount="4"/>
                                <Label fx:id="threadCountLabel" text="Threads: 10"
                                       styleClass="input-label"/>
                            </children>
                        </VBox>

                        <!-- Action Buttons -->
                        <HBox spacing="10.0" alignment="CENTER" VBox.vgrow="ALWAYS">
                            <VBox.margin>
                                <Insets top="20.0"/>
                            </VBox.margin>
                            <children>
                                <Button fx:id="startScanButton" text="Start Scan"
                                        styleClass="primary-button" prefWidth="170.0"/>
                                <Button fx:id="stopScanButton" text="Stop"
                                        styleClass="secondary-button" prefWidth="90.0" disable="true"/>
                            </children>
                        </HBox>
                    </children>
                </VBox>

                <!-- Right Panel: Results -->
                <VBox HBox.hgrow="ALWAYS" styleClass="results-card" spacing="15.0">
                    <padding>
                        <Insets topRightBottomLeft="20.0"/>
                    </padding>
                    <children>
                        <Label text="Scan Results" styleClass="card-title">
                            <font>
                                <Font name="System Bold" size="16.0"/>
                            </font>
                        </Label>

                        <!-- Progress Section -->
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                            <VBox.margin>
                                <Insets bottom="10.0"/>
                            </VBox.margin>
                            <children>
                                <ProgressBar fx:id="scanProgressBar" prefWidth="350.0"
                                             progress="0.0" styleClass="scan-progress"/>
                                <Label fx:id="statusLabel" text="Ready to scan..."
                                       styleClass="status-label"/>
                            </children>
                        </HBox>

                        <!-- Results Table -->
                        <TableView fx:id="resultsTable" VBox.vgrow="ALWAYS"
                                   styleClass="results-table">
                            <columns>
                                <TableColumn fx:id="portColumn" text="Port"
                                             prefWidth="75.0" sortable="true"/>
                                <TableColumn fx:id="serviceColumn" text="Service"
                                             prefWidth="120.0" sortable="true"/>
                                <TableColumn fx:id="statusColumn" text="Status"
                                             prefWidth="100.0" sortable="true"/>
                                <TableColumn fx:id="responseTimeColumn" text="Time (ms)"
                                             prefWidth="100.0" sortable="true"/>
                            </columns>
                            <columnResizePolicy>
                                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                            </columnResizePolicy>
                        </TableView>

                        <!-- Summary Section -->
                        <HBox styleClass="summary-box" spacing="30.0" alignment="CENTER_LEFT">
                            <padding>
                                <Insets topRightBottomLeft="15.0"/>
                            </padding>
                            <VBox.margin>
                                <Insets top="10.0"/>
                            </VBox.margin>
                            <children>
                                <VBox spacing="5.0">
                                    <children>
                                        <Label fx:id="summaryFoundLabel" text="Open Ports: 0"
                                               styleClass="summary-label-found"/>
                                        <Label fx:id="summaryClosedLabel" text="Closed Ports: 0"
                                               styleClass="summary-label-info"/>
                                    </children>
                                </VBox>
                                <VBox spacing="5.0">
                                    <children>
                                        <Label fx:id="summaryDurationLabel" text="Duration: 0.0s"
                                               styleClass="summary-label-duration"/>
                                        <Label fx:id="summarySpeedLabel" text="Speed: 0 ports/s"
                                               styleClass="summary-label-info"/>
                                    </children>
                                </VBox>
                            </children>
                        </HBox>

                        <!-- Export Button -->
                        <HBox spacing="10.0" alignment="CENTER_RIGHT">
                            <VBox.margin>
                                <Insets top="10.0"/>
                            </VBox.margin>
                            <children>
                                <Button fx:id="exportButton" text="Export Results"
                                        styleClass="secondary-button" disable="true"/>
                                <Button fx:id="clearButton" text="Clear"
                                        styleClass="secondary-button"/>
                            </children>
                        </HBox>
                    </children>
                </VBox>
            </HBox>
        </children>
    </VBox>
</AnchorPane>